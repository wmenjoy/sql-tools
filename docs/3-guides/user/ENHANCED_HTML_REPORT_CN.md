---
type: User Guide
component: Reporting
version: 1.0
created: 2024-12-01
updated: 2025-01-16
status: Active
maintainer: SQL Safety Guard Team
language: zh-CN
---

# 增强版 HTML 报告使用指南

## 概述

增强版 HTML 报告提供了更强大的交互式功能，帮助您更高效地分析和管理 SQL 安全扫描结果。

## 主要特性

### 1. 📊 统计仪表板

- **扫描 SQL 总数**: 显示扫描的 SQL 语句总数
- **严重/高危/中危/低危**: 按风险级别分类统计
- **违规总数**: 所有违规的总数
- **错误类型数**: 不同类型的错误数量
- **动态查询**: QueryWrapper 等动态查询构建器的使用次数

### 2. 🎯 智能侧边栏过滤器 (新增)

**右侧固定侧边栏**，提供快速过滤功能：

#### 错误类型过滤
- 显示所有错误类型及其数量
- **点击即可筛选**，再次点击取消筛选
- 按数量降序排列，优先显示最常见的问题

#### 文件过滤
- 显示前 20 个问题最多的文件
- **点击即可筛选**，再次点击取消筛选
- 按数量降序排列

#### 一键清除
- 点击"清除所有过滤"按钮，重置所有筛选条件

### 3. 🔍 搜索和过滤

#### 搜索功能
- 支持搜索文件名、Mapper ID、错误信息
- 实时搜索，即时显示结果
- 按 Enter 键快速搜索
- **与侧边栏过滤器联动**，可组合使用

#### 风险级别过滤
- ☑️ 严重 (CRITICAL)
- ☑️ 高危 (HIGH)
- ☑️ 中危 (MEDIUM)
- ☑️ 低危 (LOW)

可以勾选/取消勾选来快速过滤不同风险级别的违规。
**与侧边栏过滤器和搜索联动**，实现多条件组合筛选。

### 3. 📑 多维度分组展示

#### Tab 1: 全部违规
按扫描顺序显示所有违规，便于全局查看。

#### Tab 2: 按严重程度
将违规按风险级别分组：
- 严重 (CRITICAL)
- 高危 (HIGH)
- 中危 (MEDIUM)
- 低危 (LOW)

**✨ 新功能**：每组标题可点击，点击后自动筛选只显示该级别的违规。

每组显示违规数量，方便优先处理高风险问题。

#### Tab 3: 按错误类型
将违规按错误类型分组：
- SQL 注入风险
- WHERE 条件缺失
- 分页问题
- SELECT * 使用
- 敏感表访问
- LIMIT 参数问题
- ORDER BY 注入
- 其他安全问题

**✨ 新功能**：每组标题可点击，点击后自动筛选只显示该类型的违规。

每组显示违规数量，按数量降序排列，帮助识别最常见的问题类型。

#### Tab 4: 按文件
将违规按文件分组，显示每个文件中的所有违规。

**✨ 新功能**：每组标题可点击，点击后自动筛选只显示该文件的违规。

每组显示违规数量，按数量降序排列，帮助识别问题最多的文件。

### 4. 📝 详细的违规卡片

每个违规以卡片形式展示，包含：

#### 基本信息
- **Mapper ID**: 完整的 Mapper 方法标识
- **文件路径和行号**: 精确定位问题位置
- **风险级别徽章**: 颜色编码的风险级别
- **错误类型徽章**: 错误分类标签

#### 错误详情
- **错误消息**: 详细的问题描述（中文）
- **Java 方法签名**: 对应的 Java 接口方法（如果有）
- **XML 语句**: 完整的 MyBatis XML 语句
- **SQL 语句**: 如果没有 XML，则显示 SQL 代码
- **建议**: 具体的修复建议（中文）

#### 代码高亮
- XML 代码：浅色背景，易于阅读
- SQL 代码：深色背景，专业编辑器风格

### 5. 🎨 现代化 UI 设计

- **响应式布局**: 支持桌面和移动设备
- **渐变色标题**: 美观的紫色渐变
- **卡片式设计**: 清晰的层次结构
- **悬停效果**: 交互反馈
- **颜色编码**: 
  - 🔴 严重 (红色)
  - 🟡 高危 (黄色)
  - 🔵 中危 (蓝色)
  - ⚫ 低危 (灰色)

## 使用方法

### 生成报告

```bash
java -jar sql-scanner-cli.jar \
  -p /path/to/project \
  -c config.yml \
  -f html \
  -o report.html
```

### 打开报告

在浏览器中打开生成的 `report.html` 文件。

### 快速上手

1. **查看统计**: 首先查看仪表板，了解整体情况
2. **优先处理**: 点击"按严重程度"标签，从 CRITICAL 开始修复
3. **快速筛选**: 
   - 方式 1：点击分组标题（如"严重"、"SQL 注入风险"、"UserMapper.xml"）
   - 方式 2：使用右侧侧边栏点击错误类型或文件名
   - 方式 3：使用顶部搜索框输入关键词
4. **组合过滤**: 可以同时使用多个过滤条件，例如：
   - 选择"SQL 注入风险" + 勾选"CRITICAL" = 只看严重的 SQL 注入
   - 选择"UserMapper.xml" + 搜索"WHERE" = 只看该文件中的 WHERE 问题
5. **清除过滤**: 点击侧边栏底部的"清除所有过滤"按钮，或再次点击已选中的过滤项
6. **分析趋势**: 点击"按错误类型"标签，识别最常见的问题模式
7. **文件聚焦**: 点击"按文件"标签，找出问题最多的文件

## 最佳实践

### 1. 优先级处理

```
CRITICAL → HIGH → MEDIUM → LOW
```

始终先处理严重和高危问题。

### 2. 批量修复

使用"按错误类型"视图，批量修复同类问题，提高效率。

### 3. 文件级别审查

使用"按文件"视图，逐个文件审查和修复，确保完整性。

### 4. 定期扫描

- 每次代码提交前扫描
- 集成到 CI/CD 流程
- 定期生成报告追踪改进

### 5. 团队协作

- 分享 HTML 报告给团队成员
- 使用搜索功能快速定位负责的模块
- 按文件分配修复任务

## 与控制台报告的对比

| 特性 | 控制台报告 | 增强版 HTML 报告 |
|------|-----------|----------------|
| 输出方式 | 终端文本 | 网页 HTML |
| 搜索功能 | ❌ | ✅ 实时搜索 |
| 过滤功能 | ❌ | ✅ 多维度 |
| 侧边栏过滤 | ❌ | ✅ 智能侧边栏 |
| 点击筛选 | ❌ | ✅ 分组标题可点击 |
| 组合过滤 | ❌ | ✅ 多条件联动 |
| 分组展示 | ❌ | ✅ (4种维度) |
| 代码高亮 | 有限 | ✅ 完整 |
| XML 显示 | ✅ | ✅ 完整格式化 |
| Java 签名 | ✅ | ✅ |
| 交互性 | ❌ | ✅ 丰富 |
| 分享性 | 较差 | ✅ 优秀 |
| 移动端 | ❌ | ✅ 响应式 |

## 技术细节

### 浏览器兼容性

- Chrome/Edge: ✅ 完全支持
- Firefox: ✅ 完全支持
- Safari: ✅ 完全支持
- IE11: ⚠️ 部分支持

### 文件大小

- 小型项目 (< 100 违规): < 500KB
- 中型项目 (100-500 违规): 500KB - 2MB
- 大型项目 (> 500 违规): > 2MB

### 性能

- 搜索响应: < 100ms
- 过滤切换: < 50ms
- Tab 切换: < 50ms

## 常见问题

### Q1: 报告文件很大，如何优化？

**A**: 
- 使用风险级别过滤，只关注高优先级问题
- 分模块生成报告
- 修复问题后重新扫描，减少违规数量

### Q2: 搜索不到预期结果？

**A**: 
- 检查风险级别过滤器是否勾选
- 尝试使用部分关键词
- 确认大小写（搜索不区分大小写）

### Q3: 如何分享报告给团队？

**A**: 
- 直接发送 HTML 文件（单文件，无外部依赖）
- 上传到内部文件服务器
- 集成到 CI/CD 的构建产物中

### Q4: 中文显示乱码？

**A**: 
- 确保浏览器编码设置为 UTF-8
- 使用现代浏览器（Chrome/Firefox/Edge）
- 检查 HTML 文件编码是否为 UTF-8

### Q5: 如何自定义报告样式？

**A**: 
目前不支持自定义样式。如有需求，可以：
- 修改 `EnhancedHtmlReportGenerator.java` 中的 CSS
- 重新编译项目

## 更新日志

### v1.0.0 (2025-12-16)

**新增功能**:
- ✅ 搜索和过滤功能
- ✅ 4 种分组维度（全部、严重程度、错误类型、文件）
- ✅ 错误类型自动分类
- ✅ 完整的 XML 和 Java 代码显示
- ✅ 现代化卡片式 UI
- ✅ 响应式设计
- ✅ 中文界面和消息

**改进**:
- 更清晰的视觉层次
- 更好的代码可读性
- 更快的交互响应
- 更友好的用户体验

## 反馈和建议

如有问题或建议，请提交 Issue 或 Pull Request。

---

**提示**: 建议使用 Chrome 或 Firefox 浏览器以获得最佳体验。

